.include "zerop.inc"
.include "sprite.inc"
.include "shapes.inc"
.include "m16.mac"
.include "math.mac"
.include "system.mac"
.include "screen.mac"

.export _draw_string,_debug_string
;;; 7 pixel tall letters
.define TEXT_HEIGHT 7

.data
string1:
.asciiz     "abcdefghijklmnopqrstuvwxyz012"
letter_table:
OFFSET      .set 0
.repeat     26
            .byte OFFSET
OFFSET      .set OFFSET + 7
.endrep

string_offset:
            .byte 0
.code
.proc       _draw_string
            lda #0
            sta string_offset
            lda #TEXT_HEIGHT
            sta height
loop:
            ldy string_offset
            lda (ptr_string),y
            beq done
            cmp #' '
            beq next
            sec
            sbc #'a'
            tax
            lda letter_table,x

            clc
            adc #<(_LETTERS)
            sta ptr_0
            lda #>(_LETTERS)
            adc #0
            sta ptr_0+1

            jsr draw_unshifted_sprite
next:
            inc string_offset
            lda #6
            clc
            adc s_x
            sta s_x
            jmp loop
done:
            rts
.endproc


.proc       _debug_string
            saveall
            lda #175-7
            sta s_y
            lda #0
            sta s_x
            pushw ptr_0
            jsr _draw_string
            popw ptr_0
            resall
            rts
.endproc

.data
_LETTERS:
	.byte  %00100000,%01010000,%10001000,%11111000,%10001000,%10001000,%10001000 ;A
	.byte  %11110000,%10001000,%10001000,%11110000,%10001000,%10001000,%11110000 ;B
	.byte  %01110000,%10001000,%10000000,%10000000,%10000000,%10001000,%01110000 ;C
	.byte  %11100000,%10010000,%10001000,%10001000,%10001000,%10010000,%11100000 ;D
	.byte  %11111000,%10000000,%10000000,%11100000,%10000000,%10000000,%11111000 ;E
	.byte  %11111000,%10000000,%10000000,%11100000,%10000000,%10000000,%10000000 ;F
	.byte  %01110000,%10001000,%10000000,%10111000,%10001000,%10001000,%01110000 ;G
	.byte  %10001000,%10001000,%10001000,%11111000,%10001000,%10001000,%10001000 ;H
            .byte  %01110000,%00100000,%00100000,%00100000,%00100000,%00100000,%01110000 ;I
	.byte  %00111000,%00010000,%00010000,%00010000,%00010000,%10010000,%01100000 ;J
	.byte  %10001000,%10010000,%10100000,%11000000,%10100000,%10010000,%10001000 ;K
	.byte  %10000000,%10000000,%10000000,%10000000,%10000000,%10000000,%11111000 ;L
	.byte  %10001000,%11011000,%10101000,%10101000,%10001000,%10001000,%10001000 ;M
	.byte  %10001000,%10001000,%11001000,%10101000,%10011000,%10001000,%10001000 ;N
	.byte  %00100000,%01010000,%10001000,%10001000,%10001000,%01010000,%00100000 ;O
	.byte  %11110000,%10001000,%10001000,%11110000,%10000000,%10000000,%10000000 ;P
	.byte  %00100000,%01010000,%10001000,%10001000,%10101000,%01010000,%00101000 ;Q
	.byte  %11110000,%10001000,%10001000,%11110000,%10010000,%10001000,%10000000 ;R
	.byte  %01110000,%10001000,%10000000,%01110000,%00001000,%00001000,%11110000 ;S
	.byte  %11111000,%00100000,%00100000,%00100000,%00100000,%00100000,%00100000 ;T
	.byte  %10001000,%10001000,%10001000,%10001000,%10001000,%10001000,%01110000 ;U
	.byte  %10001000,%10001000,%10001000,%10001000,%10001000,%01010000,%00100000 ;V
	.byte  %10001000,%10001000,%10001000,%10001000,%10101000,%11011000,%10001000 ;W
	.byte  %10001000,%10001000,%01010000,%00100000,%01010000,%10001000,%10001000 ;X
	.byte  %10001000,%10001000,%10001000,%01110000,%00100000,%00100000,%00100000 ;Y
	.byte  %11111000,%00001000,%00010000,%00100000,%01000000,%10000000,%11111000 ;Z
	;; digits
	.byte  %01110000,%10001000,%10001000,%10101000,%10001000,%10001000,%01110000
	.byte  %00100000,%01100000,%10100000,%00100000,%00100000,%00100000,%11111000
	.byte  %11110000,%00001000,%00001000,%00110000,%11000000,%10000000,%11111000
	.byte  %11110000,%00001000,%00001000,%01110000,%00001000,%00001000,%11110000
	.byte  %00010000,%00110000,%01010000,%10010000,%11111000,%00010000,%00010000
	.byte  %11111000,%10000000,%11100000,%00010000,%00001000,%00010000,%11100000
	.byte  %00000000,%00000000,%00000000,%00000010,%00000000,%00000000,%00000000
	.byte  %11111000,%00001000,%00010000,%00100000,%01000000,%01000000,%01000000
	.byte  %01110000,%10001000,%10001000,%01110000,%10001000,%10001000,%01110000
	.byte  %01110000,%10001000,%10001000,%01111000,%00001000,%00010000,%01100000
